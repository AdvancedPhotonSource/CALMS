BraggNN: Deep Learning for X-ray Diffraction Microscopy

​

Artificial intelligence (AI) systems using deep-learning neural networks are revolutionizing many scientific disciplines because of their ability to process, learn from, and make predictions from vast amounts of data.  A group of researchers at the U.S. Department of Energy’s (DOE’s) Argonne National Laboratory is now harnessing the great power of AI for an as-yet untried task of AI, the computationally challenging job of analyzing high-energy x-ray diffraction microscopy (HEDM) data.  Their machine-learning-based method, called BraggNN, can precisely characterize Bragg peaks in HEDM with far greater speed and efficiency than conventional methods.  The work, which used data obtained at the DOE’s Advanced Photon Source (APS), was published in the International Union of Crystallography Journal.

In recent years, HEDM has become one of the major techniques used for the accurate characterization of advanced materials with high resolution, providing three-dimensional data on critical new polycrystalline structures non-destructively.  While x-ray HEDM has proven to be a great improvement over previous techniques, it can also be computationally expensive and time-consuming, involving data collection, Bragg peak analysis, and reconstruction from the Bragg peak data.  

The impending upgrade of the APS is expected to vastly improve the speed of data acquisition from 6-15 minutes to 50-100 seconds, but the processing time to complete analysis and fitting of multiple Bragg peaks can range from several minutes to several weeks, even with the largest supercomputers. These delays slow research and they also prevent the use of HEDM information to steer experiments, for example to track evolving phenomena such as emerging cracks in materials.

To address these challenges, the researchers from the Argonne X-ray Science Division (XSD) and Data Science and Learning Division (DSL) sought to accelerate and streamline Bragg peak analysis by applying deep-learning methods.  Diffraction peak data are conventionally fitted to a Voigt or pseudo-Voigt two-dimensional or three-dimensional peak profile, so the research team sought to develop a deep-learning model to directly determine peak positions.  Using a series of convolutional neural networks (CNN), the BraggNN model was trained via a test dataset of input-output peak patches from HEDM scans of a bicrystal gold sample, with the output previously obtained from conventional pseudo-Voigt fitting. Information passes through the CNN layers, each of which extracts a particular feature from the data patch, to a fully connected neural network, which finally produces a set of x and y coordinates of each Bragg peak.  

To improve the outcome of the training process, a data augmentation technique was applied that increases the diversity of the input data and avoids overfitting to an overly specific dataset, which can be a disadvantage of deep neural networks.  Using a physics-based approach that introduced random peak center deviations in cropped input patches allows the BraggNN model to handle a broader range of data, including noisy or cropped data frames.  

After BraggNN was trained, the researchers first assessed its performance by comparing its predicted diffraction peak positions with those obtained through the conventional pseudo-Voigt fitting method.  This demonstrated less than 0.29 pixels of deviation for 75% and 0.57 pixels of deviation for 95% of the peaks with BraggNN.  The experimenters then conducted comparisons of BraggNN's performance on a different dataset of far-field-HEDM and near-field-HEDM data (ground truth) from a Ti-7Al sample undergoing deformation at the Materials Physics & Engineering Group’s 1-ID-E x-ray beamline at the APS (an Office of Science user facility at Argonne), which allowed a 1-to-1 comparison of the reconstructed center-of-mass grain positions. Here, the BraggNN model showed approximately 15% smaller uncertainties in grain positions than calculated from the conventional pseudo-Voigt method.

Aside from increased accuracy, BraggNN is also markedly faster than pseudo-Voigt fitting calculations, running at about 50 times faster on a typical central processing unit system and up to 350 times faster on a graphics processing unit.  Such substantial improvement in processing times promises significant advantages for analysis and experiment steering in real time.

The researchers intend to develop BraggNN to enhance its capabilities to handle far more complex jobs than demonstrated in the present work, including datasets containing overlapping or asymmetric peaks and deformed grains.  As the vast potential of deep-learning systems continues to be developed and improved, its utility for computationally demanding tasks such as Bragg peak characterization promises to greatly accelerate the design and characterization of new materials.  ― Mark Wolverton

Zhengchun Liu*, Hemant Sharma**, Jun-Sang Park, Peter Kenesei, Antonino Miceli, Jonathan Almer, Rajkumar Kettimuthu, and Ian Foster, “BraggNN: fast X-ray Bragg peak analysis using deep learning,” IUCrJ 9, 104 (2022). DOI: 10.1107/S2052252521011258

Correspondence: * zhengchun.liu@anl.gov, ** hsharma@anl.gov

This material was based upon work supported by the U.S. Department of Energy (DOE) Office of Science (contract No. DE-AC02-06CH11357) and Basic Energy Sciences (award No. FWP-35896). This research used resources of the Argonne Leadership Computing Facility, which is a DOE Office of Science User Facility (contract No. DE-AC02- 06CH11357). This research used resources of the Advanced Photon Source, a US Department of Energy (DOE) Office of Science User Facility operated for the DOE Office of Science by Argonne National Laboratory under contract no. DE-AC02-06CH11357.

The U.S. Department of Energy's APS at Argonne National Laboratory is one of the world’s most productive x-ray light source facilities. Each year, the APS provides high-brightness x-ray beams to a diverse community of more than 5,000 researchers in materials science, chemistry, condensed matter physics, the life and environmental sciences, and applied research. Researchers using the APS produce over 2,000 publications each year detailing impactful discoveries, and solve more vital biological protein structures than users of any other x-ray light source research facility. APS x-rays are ideally suited for explorations of materials and biological structures; elemental distribution; chemical, magnetic, electronic states; and a wide range of technologically important engineering systems from batteries to fuel injector sprays, all of which are the foundations of our nation’s economic, technological, and physical well-being.

Argonne National Laboratory seeks solutions to pressing national problems in science and technology. The nation's first national laboratory, Argonne conducts leading-edge basic and applied scientific research in virtually every scientific discipline. Argonne researchers work closely with researchers from hundreds of companies, universities, and federal, state and municipal agencies to help them solve their specific problems, advance America's scientific leadership and prepare the nation for a better future. With employees from more than 60 nations, Argonne is managed by UChicago Argonne, LLC, for the U.S. DOE Office of Science.

The U.S. Department of Energy's Office of Science is the single largest supporter of basic research in the physical sciences in the United States and is working to address some of the most pressing challenges of our time. For more information, visit the Office of Science website.

Published Date

02.22.2022